<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>창동 맛집 모음</title>
        <link rel="stylesheet" href="/static/css/index.css" />
        <!-- head include -->
        <%- include('./include/head') %>
    </head>
    <body>
        <!-- header include -->
        <%- include('./include/header') %>
        <div
            style="
                padding-top: 100px;
                display: flex;
                justify-content: center;
                gap: 20px;
                text-align: center;
            "
        >
            <img src="/static/images/CMM.png" alt="" style="width: 70px; height: auto" />
            <h1>모든식당</h1>
        </div>

        <div style="width: 1350px; margin: 0 auto">
            <div style="max-width: 1350px; margin: 0 auto">
                <div class="restaurantMenu" id="restaurantMenu1" style="padding-top: 50px">
                    <div
                        class="restaurantContainer"
                        style="
                            display: grid;
                            grid-template-columns: repeat(3, minmax(0, 1fr));
                            gap: 20px;
                            justify-items: center;
                        "
                    >
                        <% console.log("레스토랑 정보 >> ",restaurants) %> <% for (let i = 0; i <
                        restaurants.length; i++) { %>
                        <div class="restaurantItem" style="max-width: 410px">
                            <a href="/restaurantDetail/<%=restaurants[i].rest_index%>">
                                <div class="imageContainer">
                                    <img
                                        src="/static/images/<%= restaurants[i].rest_index %>.png"
                                        alt="Restaurant 1"
                                        class="RestaurantImage"
                                        style="width: 100%; height: auto"
                                    />
                                    <span class="label"><%= restaurants[i].rest_name %></span>
                                    <span class="labelStar">리뷰</span>
                                </div>
                            </a>
                // 오류 수정 중입니다...
                // <script>
                //     document.addEventListener("DOMContentLoaded", function () {
                //         const moreButton = document.querySelector(".moreButton");
                //         const moreRow = document.querySelector(".moreRow");
                //         const restaurantRows = document.querySelectorAll(".restaurantRow");

                //         moreButton.addEventListener("click", async function () {
                //             // 더보기 버튼을 클릭할 때마다 나머지 식당 불러오기
                //             // 이 부분 오류 수정
                //             // router에 이부분 존재하지 않음
                //             // restaurants 정보를 보유중..
                //             //
                //             //
                //             const response = await fetch("/loadMoreRestaurants");
                //             const newRestaurants = await response.json();

                //             // 레스토랑 정보 추가
                //             const restaurantContainer =
                //                 document.getElementById("restaurantContainer");
                //             newRestaurants.forEach((restaurant, index) => {
                //                 if (index % 3 === 0) {
                //                     const newRow = document.createElement("tr");
                //                     newRow.classList.add("restaurantRow");
                //                     restaurantContainer.appendChild(newRow);
                //                 }
                //                 const newCell = document.createElement("td");
                //                 newCell.classList.add("restaurantCell");
                //                 newCell.innerHTML = `
                //     <a href="/restaurantDetail/${restaurant.rest_index}">
                //         <div class="imageContainer">
                //             <img src="/static/images/${restaurant.rest_index}.png" alt="Restaurant ${restaurant.rest_index}" class="RestaurantImage" />
                //             <span class="label">${restaurant.rest_name}</span>
                //         </div>
                //     </a>
                // `;
                //                 const lastRow = restaurantContainer.lastChild;
                //                 lastRow.appendChild(newCell);
                //             });

                //             // 더보기 버튼 숨기기
                //             moreRow.style.display = "none";
                //         });

                //         // 페이지 로드시 나머지 레스토랑 숨김
                //         for (let i = 3; i < restaurantRows.length; i++) {
                //             restaurantRows[i].style.display = "none";
                //         }
                //     });
                // </script>
                        </div>
                        <% } %>
                    </div>
                </div>
            </div>
        </div>

        <br /><br />
        <div>
            <nav aria-label="Page navigation example">
                <ul class="pagination justify-content-center">
                    <li class="page-item disabled">
                        <a class="page-link">Previous</a>
                    </li>
                    <li class="page-item"><a class="page-link" href="#">1</a></li>
                    <li class="page-item"><a class="page-link" href="#">2</a></li>
                    <li class="page-item"><a class="page-link" href="#">3</a></li>
                    <li class="page-item">
                        <a class="page-link" href="#">Next</a>
                    </li>
                </ul>
            </nav>
        </div>

        <!-- footer include -->
        <%- include('./include/footer') %>

        <script>
            // 검색 버튼에 이벤트 리스너 추가
            document.getElementById("searchButton").addEventListener("click", searchKeyword);

            // 키워드로 검색하여 테이블을 채우는 함수
            async function searchKeyword() {
                try {
                    const keyword = document.getElementById("searchInput").value.trim(); // 입력값의 앞뒤 공백 제거
                    if (!keyword) {
                        return; // 검색어가 없으면 함수 종료
                    }
                    document.location.href = `/search?keyword=${keyword}`;
                } catch (error) {
                    console.error("데이터 가져오기 오류:", error);
                }
            }

            // 엔터 키 입력 시 검색 실행
            document.getElementById("searchInput").addEventListener("keypress", function (event) {
                if (event.key === "Enter") {
                    searchKeyword();
                }
            });
        </script>
    </body>
</html>
